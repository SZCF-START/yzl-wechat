<view class="page-container">
  <!-- 顶部固定区域：显示取还车日期与星期 -->
  <view class="top-fixed">
    <view class="date-container">
      <!-- 取车日期 -->
      <view class="date-item">
        <text class="date-text">{{ startDateDisplay || "取车日期" }}</text>
        <view class="time-container">
          <text class="week-text">{{ startWeek || "请选择" }}</text>
          <text class="time-text">{{ startTimeRaw || "" }}</text>
        </view>
      </view>
      <!-- 箭头图标 -->
      <image class="arrow-icon" src="/images/arrow.png" mode="widthFix" />
      <!-- 还车日期 -->
      <view class="date-item">
        <text class="date-text">{{ endDateDisplay || "还车日期" }}</text>
        <view class="time-container">
          <text class="week-text">{{ endWeek || "请选择" }}</text>
          <text class="time-text">{{ endTimeRaw || "" }}</text>
        </view>
      </view>
    </view>
  </view>


  <!-- 中间区域：van‑calendar 日期区间选择（滚动区域） -->
  <scroll-view class="calendar-scroll" scroll-y="true">
    <view class="calendar-container">
      <van-calendar
        title=""
        poppable="{{ false }}"
        type="range"
        default-date="{{ dateRange }}"
        color="#80c269"
        min-date="{{ minDate }}"
        max-date="{{ maxDate }}"
        show-subtitle="{{ false }}"
        show-mark="{{ false }}"
        show-confirm="{{ false }}"
        allow-same-day="{{ true }}"
        formatter="{{formatter}}"
        bind:select="onSelectDate"
      />
    </view>
  </scroll-view>

  <!-- 时间选择区域：固定在底部区域上方 -->
  <view class="time-area">
  <!-- 取车时间选择器 -->
  <view class="picker-block">
    <view class="title">取车时间</view>
    <scroll-view
      class="picker-scroller"
      scroll-y
      show-scrollbar="false"
      scroll-with-animation
      scroll-top="{{startScrollTop}}"
      bindscroll="onStartTimeScrolling"
      bindscrollend="onStartScrollTouchEnd"
    >
      <!-- 上下预留空白 -->
      <view style="height:60rpx;"></view>
      <block wx:for="{{timeList}}" wx:key="index">
        <view id="start-item-{{index}}" class="picker-item">
          {{item}}
        </view>
      </block>
      <view style="height:60rpx;"></view>
    </scroll-view>
  </view>

  <!-- 还车时间选择器 -->
  <view class="picker-block">
    <view class="title">还车时间</view>
    <scroll-view
      class="picker-scroller"
      scroll-y
      show-scrollbar="false"
      scroll-with-animation
      scroll-top="{{endScrollTop}}"
      bindscroll="onEndTimeScrolling"
      bindscrollend="onEndScrollTouchEnd"
    >
      <!-- 上下预留空白 -->
      <view style="height:60rpx;"></view>
      <block wx:for="{{timeList}}" wx:key="index">
        <view id="end-item-{{index}}" class="picker-item">
          {{item}}
        </view>
      </block>
      <view style="height:60rpx;"></view>
    </scroll-view>
  </view>

  <!-- 选中区域遮罩层及高亮线 -->
  <view class="mask mask-top"></view>
  <view class="mask mask-bottom"></view>
  <view class="highlight-line line-top"></view>
  <view class="highlight-line line-bottom"></view>
</view>


  <!-- 底部固定区域：总时长显示及操作按钮 -->
  <view class="bottom-fixed">
    <view class="duration-text">
      <block wx:if="{{ totalDays || totalHours }}">
        <text>共</text>
        <block wx:if="{{ totalDays > 0 }}">
          <text>{{ totalDays }}天</text>
        </block>
        <block wx:if="{{ totalHours > 0 }}">
          <text>{{ totalHours }}小时</text>
        </block>
      </block>
    </view>
    <view class="btn-group">
      <button class="clear-btn" bindtap="onClear">清空</button>
      <!-- 根据 dateRangeComplete 状态控制按钮样式和禁用 -->
      <button class="confirm-btn {{ !dateRangeComplete ? 'disabled' : '' }}" 
              bindtap="onConfirm" 
              disabled="{{ !dateRangeComplete }}">确定</button>
    </view>
  </view>
</view>
