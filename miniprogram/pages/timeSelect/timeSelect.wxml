<view class="page-container">
  <!-- 顶部固定区域：显示取还车日期与星期 -->
  <view class="top-fixed">
    <view class="date-container">
      <!-- 取车日期 -->
      <view class="date-item">
        <text class="date-text">{{ startDateDisplay || "取车日期" }}</text>
        <view class="time-container">
          <text class="week-text">{{ startWeek || "请选择" }}</text>
          <text class="time-text">{{ startTimeRaw || "" }}</text>
        </view>
      </view>
      <!-- 箭头图标 -->
      <image class="arrow-icon" src="/images/arrow.png" mode="widthFix" />
      <!-- 还车日期 -->
      <view class="date-item">
        <text class="date-text">{{ endDateDisplay || "还车日期" }}</text>
        <view class="time-container">
          <text class="week-text">{{ endWeek || "请选择" }}</text>
          <text class="time-text">{{ endTimeRaw || "" }}</text>
        </view>
      </view>
    </view>
  </view>


  <!-- 中间区域：van‑calendar 日期区间选择（滚动区域） -->
  <scroll-view class="calendar-scroll" scroll-y="true">
    <view class="calendar-container">
      <van-calendar
        title=""
        poppable="{{ false }}"
        type="range"
        color="#80c269"
        min-date="{{ minDate }}"
        max-date="{{ maxDate }}"
        show-subtitle="{{ false }}"
        show-mark="{{ false }}"
        show-confirm="{{ false }}"
        allow-same-day="{{ true }}"
        formatter="{{formatter}}"
        bind:select="onSelectDate"
      />
    </view>
  </scroll-view>

  <!-- 时间选择区域：固定在底部区域上方 -->
  <view class="time-area">
    <view class="time-block">
      <text class="time-label">取车时间</text>
      <scroll-view class="time-scroll" scroll-y="true">
        <block wx:for="{{ timeList }}" wx:key="item">
          <view class="time-item {{ item === startTimeRaw ? 'active' : '' }}"
                data-time="{{ item }}"
                bindtap="chooseStartTime">
            {{ item }}
          </view>
        </block>
      </scroll-view>
    </view>
    <view class="time-block">
      <text class="time-label">还车时间</text>
      <scroll-view class="time-scroll" scroll-y="true">
        <block wx:for="{{ timeList }}" wx:key="item">
          <view class="time-item {{ item === endTimeRaw ? 'active' : '' }}"
                data-time="{{ item }}"
                bindtap="chooseEndTime">
            {{ item }}
          </view>
        </block>
      </scroll-view>
    </view>
  </view>

  <!-- 底部固定区域：总时长显示及操作按钮 -->
  <view class="bottom-fixed">
    <view class="duration-text">
      <block wx:if="{{ totalDays || totalHours }}">
        共{{ totalDays }}天{{ totalHours }}小时
      </block>
    </view>
    <view class="btn-group">
      <button class="clear-btn" bindtap="onClear">清空</button>
      <!-- 根据 dateRangeComplete 状态控制按钮样式和禁用 -->
      <button class="confirm-btn {{ !dateRangeComplete ? 'disabled' : '' }}" 
              bindtap="onConfirm" 
              disabled="{{ !dateRangeComplete }}">确定</button>
    </view>
  </view>
</view>
