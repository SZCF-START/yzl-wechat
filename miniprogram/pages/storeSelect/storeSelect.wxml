<view class="container">
  <!-- 固定顶部搜索区域 -->
<view class="header">
  <view class="search-wrapper">
    <!-- 城市选择 + 搜索框部分 -->
    <view class="search-box">
      <view class="city-select" bindtap="onCityTap">
        <text class="city-text">{{ currentCity }} ▾</text>
      </view>
      <view class="divider"></view>
      <!-- 搜索框 -->
      <view class="search-bar" bindtap="onSearchTap">
        <image class="search-icon" src="/assets/search.png" />
        <text class="search-placeholder">输入景点、地址寻找附近门店</text>
      </view>
    </view>

    <!-- 地图按钮 -->
    <view class="map-btn" bindtap="onMapTap">地图</view>
  </view>
</view>

<!-- 搜索蒙层 -->
<view wx:if="{{showSearchMask}}" class="mask-layer">
  <view class="search-header">
    <input class="search-input" placeholder="请输入门店名、地址" />
    <text class="cancel-btn" bindtap="onCancelSearch">取消</text>
  </view>
</view>

<view class="header-placeholder"></view>

  <!-- 地图 -->
  <view class="map-container">
  <map
    id="storeMap"
    latitude="{{latitude}}"
    longitude="{{longitude}}"
    scale="14"
    show-location
    markers="{{markers}}"
    style="width: 100%; height: 100%;">
  </map>

  <!-- 覆盖在地图上的按钮 -->
  <cover-view class="map-overlay">
    <cover-view class="view-map-btn" bindtap="onViewBigMap">看大地图</cover-view>
  </cover-view>
</view>


  <!-- 门店列表 -->
  <view class="store-section">
    <!-- 左侧区域列表 -->
    <scroll-view scroll-y class="area-list" bindtap="onAreaTap">
      <block wx:for="{{areaList}}" wx:key="name">
        <view
          class="area-item {{selectedAreaIndex === index ? 'active' : ''}}"
          data-index="{{index}}"
        >{{item.name}}</view>
      </block>
    </scroll-view>

    <!-- 右侧门店列表 -->
    <scroll-view scroll-y class="store-list" bindscroll="onStoreScroll">
      <block wx:for="{{areaList}}" wx:key="name">
        <view class="area-section" id="area-{{index}}">
          <view class="area-title">{{item.name}}</view>
          <block wx:for="{{item.stores}}" wx:key="name">
            <view class="store-card">
              <view class="store-header">
                <text class="store-name">{{item.name}}</text>
                <text class="tag" wx:if="{{item.supportSelfReturn}}">部分支持自助取还</text>
                <text class="tag yellow" wx:if="{{item.beeBox}}">蜂巢柜</text>
                <text class="tag orange" wx:if="{{item.orderableTomorrow}}">可下全天订单</text>
              </view>
              <view class="store-addr">地址：{{item.address}}</view>
              <view class="store-time">营业时间：{{item.openTime}} - {{item.closeTime}}</view>
              <view class="store-actions">
                <button class="phone-btn">📞 电话</button>
                <button class="guide-btn">📍 门店指引</button>
              </view>
            </view>
          </block>
        </view>
      </block>
    </scroll-view>
  </view>
</view>
